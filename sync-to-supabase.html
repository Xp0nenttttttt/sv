<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Copie localStorage ‚Üí Supabase</title>
    <script src="storage-adapter.js"></script>
    <script src="supabase-config.js"></script>
</head>

<body>
    <h1>Copie des donn√©es vers Supabase</h1>
    <button onclick="copyToSupabase()">üì§ Copier localStorage ‚Üí Supabase</button>
    <pre id="log"></pre>

    <script>
        async function copyToSupabase() {
            const log = document.getElementById('log');
            log.textContent = '‚è≥ Chargement Supabase...\n';

            try {
                await enableSupabaseStorage();
                log.textContent += '‚úÖ Supabase connect√©\n\n';

                // Lire depuis localStorage
                const submissions = localStorage.getItem('svChallengeSubmissions');
                const records = localStorage.getItem('svChallengeRecordSubmissions');

                if (submissions) {
                    log.textContent += 'üì§ Copie des submissions...\n';
                    await universalStorage.setData('svChallengeSubmissions', JSON.parse(submissions));
                    log.textContent += '‚úÖ Submissions copi√©es\n';
                } else {
                    log.textContent += '‚ö†Ô∏è Pas de submissions dans localStorage\n';
                }

                if (records) {
                    log.textContent += 'üì§ Copie des records...\n';
                    await universalStorage.setData('svChallengeRecordSubmissions', JSON.parse(records));
                    log.textContent += '‚úÖ Records copi√©s\n';
                } else {
                    log.textContent += '‚ö†Ô∏è Pas de records dans localStorage\n';
                }

                log.textContent += '\n‚úÖ Synchronisation termin√©e!\n';
                log.textContent += '\nVous pouvez maintenant ouvrir le site sur un autre PC.\n';
            } catch (error) {
                log.textContent += '\n‚ùå Erreur: ' + error.message + '\n';
                console.error(error);
            }
        }
    </script>
</body>

</html>